<!DOCTYPE html>
<html lang="en">
  <head>
    <title>TypedNotification  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="TypedNotification  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">TypedNotification Docs</a> (95% documented)</p>
        <p class="header-right"><a href="https://github.com/alexjohnj/TypedNotification"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">TypedNotification Reference</a>
        <img id="carat" src="img/carat.png" />
        TypedNotification  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/NotificationObservation.html">NotificationObservation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NotificationObservationBag.html">NotificationObservationBag</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/NotificationCenter.html">NotificationCenter</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/TypedNotification.html">TypedNotification</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/TypedNotificationCenter.html">TypedNotificationCenter</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='typednotification' class='heading'>TypedNotification</h1>

<p><em>TypedNotification</em> is a Swift library that adds some type-safety to
Foundation&rsquo;s <code>NotificationCenter</code>. The library is small and can be added to your
project either as a static framework or by directly including the single source
file.</p>
<h2 id='usage' class='heading'>Usage</h2>
<h3 id='playground' class='heading'>Playground</h3>

<p>This repository includes an annotated playground that demonstrates the features
of <em>TypedNotification</em>. To use it:</p>

<ol>
<li>Clone the repository.</li>
<li>Open <code>TypedNotification.xcworkspace</code></li>
<li>Build the <em>TypedNotification (Playground)</em> scheme.</li>
<li>Open the <em>Demo</em> playground and run it.</li>
</ol>
<h3 id='overview' class='heading'>Overview</h3>

<p>For each notification in your application, create a new type that conforms to
the <code><a href="Protocols/TypedNotification.html">TypedNotification</a></code> protocol:</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">DataStoreDidSaveNotification</span><span class="p">:</span> <span class="kt">TypedNotification</span> <span class="p">{</span>

    <span class="c1">/// The data store posting the notification.</span>
    <span class="k">let</span> <span class="nv">object</span><span class="p">:</span> <span class="kt">DataStore</span> <span class="c1">// &lt;- This property is required by the protocol.</span>

    <span class="k">let</span> <span class="nv">insertedObjects</span><span class="p">:</span> <span class="kt">Set</span><span class="o">&lt;</span><span class="kt">Model</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre>

<p>When conforming, you must provide a type and the storage for an object attached
to the notification. Additional data that would normally be included in a
notification&rsquo;s <code>userInfo</code> dictionary can be provided as properties on the
notification.</p>

<p>To post a notification, create an instance of the notification and call post(_:)
on a <code>NotificationCenter</code>:</p>
<pre class="highlight swift"><code><span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="kt">DataStoreDidSaveNotification</span><span class="p">(</span><span class="nv">object</span><span class="p">:</span> <span class="n">dataStore</span><span class="p">,</span> <span class="nv">insertedObjects</span><span class="p">:</span> <span class="n">insertedObjects</span><span class="p">))</span>
</code></pre>

<p>To observe a notification use the <code>addObserver(forType:object:queue:using)</code>
method on <code>NotificationCenter</code>. This is similar to the Foundation method but
takes a type of notification to observe instead of the name and returns a
<code><a href="Classes/NotificationObservation.html">NotificationObservation</a></code> to manage the observation:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">observation</span> <span class="o">=</span> <span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">DataStoreDidSaveNotification</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">queue</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span> <span class="n">note</span> <span class="k">in</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">insertedObjects</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Note that the type of <code>note</code> passed to the callback block is a
<code>DataStoreDidSaveNotification</code>.</p>

<p>The returned <code><a href="Classes/NotificationObservation.html">NotificationObservation</a></code> instance manages the lifetime of the
observation. When the instance is deallocated, the observation stops.</p>
<h3 id='notification-observation-bags' class='heading'>Notification Observation Bags</h3>

<p><em>TypedNotification</em> provides a convenient type for working with
<code><a href="Classes/NotificationObservation.html">NotificationObservation</a></code>s. A <code><a href="Classes/NotificationObservationBag.html">NotificationObservationBag</a></code> stores multiple
observation instances and removes them all when deallocated. You can use this to
tie the lifetime of an observation to another object:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">notificationBag</span> <span class="o">=</span> <span class="kt">NotificationObservationBag</span><span class="p">()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">forType</span><span class="p">:</span> <span class="kt">DataStoreDidSaveNotification</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">queue</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="k">unowned</span> <span class="k">self</span><span class="p">]</span> <span class="n">note</span> <span class="k">in</span>
              <span class="k">self</span><span class="o">.</span><span class="nf">doSomething</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">note</span><span class="o">.</span><span class="n">insertedObjects</span><span class="p">)</span>
          <span class="p">}</span>
          <span class="o">.</span><span class="nf">stored</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">notificationBag</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Here, when a <code>ViewController</code> is deallocated, so to is its notification bag and
the observation set up in <code>viewDidLoad()</code> goes away.</p>

<p>This is really useful behaviour so <em>TypedNotification</em> includes a variant of
<code>addObserver</code> for normal <code>Notification</code>s that also returns a
<code><a href="Classes/NotificationObservation.html">NotificationObservation</a></code>:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">setUpKeyboardObservation</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nv">forNotificationNamed</span><span class="p">:</span> <span class="kt">UIWindow</span><span class="o">.</span><span class="n">keyboardWillShowNotification</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">queue</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span> <span class="n">note</span> <span class="k">in</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">userInfo</span><span class="p">?[</span><span class="kt">UIWindow</span><span class="o">.</span><span class="n">keyboardFrameEndUserInfoKey</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">stored</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="n">notificationBag</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
<h2 id='requirements-amp-installation' class='heading'>Requirements &amp; Installation</h2>

<p><em>TypedNotification</em> requires a version of Xcode that can compile Swift 5
code. Additionally it requires a deployment target targeting iOS 10+ or macOS
10.12+ because of a dependency on <code>os.lock</code>.</p>

<p>You&rsquo;ve got four options for installation.</p>
<h3 id='manual-installation' class='heading'>Manual Installation</h3>

<p>Copy <code>TypedNotification.swift</code> from the <code>Sources</code> directory.</p>
<h3 id='cocoapods' class='heading'>CocoaPods</h3>

<p>Add the following to your <code>Podfile</code>:</p>
<pre class="highlight plaintext"><code>pod 'AJJTypedNotification', '~&gt; 2.0'
</code></pre>

<p>Note that the name of the module (i.e., what you <code>import</code>) is
<em>TypedNotification</em> but the pod is <em>AJJTypedNotification</em>.</p>
<h3 id='carthage' class='heading'>Carthage</h3>

<p>Add the following to your <code>Cartfile</code>:</p>
<pre class="highlight plaintext"><code>github "alexjohnj/TypedNotification" ~&gt; 2.0
</code></pre>

<p><em>TypedNotification</em> builds as a static framework so you&rsquo;ll find the output in
<code>Build/$PLATFORM/Static</code>. Remember not to embed the framework in your
application, just link against it.</p>
<h3 id='swift-package-manager' class='heading'>Swift Package Manager</h3>

<p>Add the following to your <code>Package.swift</code> file&rsquo;s dependencies:</p>
<pre class="highlight swift"><code><span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/alexjohnj/TypedNotification.git"</span><span class="p">,</span> <span class="o">.</span><span class="nf">upToNextMinor</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="s">"2.0.0"</span><span class="p">))</span>
<span class="p">]</span>
</code></pre>
<h2 id='license' class='heading'>License</h2>

<p>MIT</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="https://alexj.org" target="_blank" rel="external">Alex Jackson</a>. All rights reserved. (Last updated: 2019-04-20)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
